<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta name="author" content="AfterMath" /><link rel="stylesheet" type="text/css" href="style.css" media="screen" /><meta name="keywords" content="mathematics, math, statistics, stats,
probability, javascript, script, programming, covariance, variance, vector, plot, points" /><meta name="description" content="This is a script that computes the covariance of two random vectors and graphs the result.  " /><title>Covariance of Vectors at LEARNINGlover.com</title>
<script type="text/javascript">
function init()
{
	var k1 = Math.floor(Math.random()*20)+5;
	var text = "<table><tr><td>x</td><td>y</td></tr>";
	
	var set1 = new Array();
	var set2 = new Array();
	
	for (var i = 0; i < k1; i++)
	{
		set1[i] = Math.floor(Math.random()*100)+1;
		var fctr = Math.random()*(.5);
		set2[i] = Math.floor(set1[i]*fctr);
		
		text += "<tr><td>" + set1[i] + "</td><td>" + set2[i] + "</td></tr>";
	}
	
	text += "</table>";
	
//	for (var i = 0; i < k1; i++)
//		text += set1[i] + ", ";
		
//	text += "<br>";
//	for (var i = 0; i < k1; i++)
//		text += set2[i] + ", ";
	
	document.getElementById("input").innerHTML = text;
	
	var ans = new Array();
	ans[0] = set1;
	ans[1] = set2;
	
	dispPts(ans);
	
	return ans;
}

function mean(set, show)
{
	var text = "";
	if (show)
		text += "";
		
	var mean = 0;
	for (var i = 0; i < set.length; i++)
		mean += set[i];
		
	mean = mean / set.length;
	
	return mean;
}

function covar(set1, set2, show)
{
	var text = "";
	if (show)
		text += "We first calculate the mean of x<br>";
	var mean1 = mean(set1, show);
	
	if (show)
		text += "Next, we calcuate the mean of y<br>";
	var mean2 = mean(set2, show);
	
	var nvec = new Array(), sum = 0;
	
	if (show)
	{
		text += "To calculate the covariance, we first compute how far each element of each vector is from its mean<br>"
		text += "<table><tr><td>x</td><td>x - <img src='http://www.learninglover.com/mu.gif'><sub>x</sub></td><td>y</td><td>y - <img src='http://www.learninglover.com/mu.gif'><sub>y</sub></td><td>(x - <img src='http://www.learninglover.com/mu.gif'><sub>x</sub>)(y - <img src='http://www.learninglover.com/mu.gif'><sub>y</sub>)</td></tr>";
	}
	
	for (var i = 0; i < set1.length; i++)
	{
		if (show)
			text += "<tr><td>" + set1[i] + "</td><td>" + set1[i] - mean1 + "</td><td>" + set2 + "</td><td>" + set2 - mean2 + "</td></tr>";
		sum += ((set1[i] - mean1)*(set2[i] - mean2));
	}
	text += "</table>";
	
	if (show)
		text += "Now to calculate the covariance, we simply simply add the terms in this last column and divide by " + set1.length + "<br>";
		
	sum = sum / (set1.length);
	
	document.getElementById(output).innerHTML += text;
	
	return sum;
}

function dispPts(inp)
{
	var i, c = document.getElementById("myCanvas");
	var ctx = c.getContext("2d");

	var text = "";
	
	ctx.clearRect(0, 0, 500, 600);
	ctx.fillStyle="#000000";

	for (i = 0; i < inp[0].length; i++)
	{
		text += i + " - (" + (4.8*inp[0][i]+10) + ", " + (600-24*inp[1][i]+12) + ")<br>";
		ctx.beginPath();
		ctx.arc(4.8*inp[0][i]+10,600-24*inp[1][i]+12,5,0,Math.PI*2,true);
		ctx.fillText(i, 4.8*inp[0][i]+10,600-24*inp[1][i]-5+12);
		ctx.closePath();
		ctx.fill();
	}
	
//	document.getElementById("output").innerHTML = text;
}

function process()
{
	var ans = new Array();
	var text = "<table>";
	for (var i = 0; i < prob.length; i++)
	{
		text += "<tr>"
		ans[i] = new Array();
		for (var j = 0; j < prob.length; j++)
		{
			ans[i][j] = covar(prob[i], prob[j]);
			text += "<td>" + Math.floor(ans[i][j]*1000)/1000 + "</td>";
		}
		text += "</tr>";
	}
	text += "</table>";
	
	document.getElementById("output").innerHTML += "Covariance Matrix = " + text;
}
</script></head><body>
<p name="input" id="input">
</p>
<input type="checkbox"> Show Work?
<input type="button" value="New Problem" onClick="init()">
<input type="button" value="Covariance" onClick="process()"><br>
<p name="output" id="output">
</p>
<canvas id="myCanvas" width="500" height="600" style="border:1px solid #d3d3d3;">
your browser does not support the canvas tag
</canvas>
<script type="text/javascript">
var prob = init();
</script>
</body></html>